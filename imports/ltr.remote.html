<html>
  <head>
    <title>ltg - Remote Access Library</title>
  </head>
  <body>
    <script>
      ltg.element('ltgRemote', function() {
        this.noShadow = true;

        this.controller(function($element, $attrs) {
          this.request = function() {};
        });
        
        this.link(function(element, attrs, ltgRemote) {
          D.bind(element, 'request', ltgRemote.request);
          D.bind(element, 'abort', ltgRemote.abort);
          D.bind(element, 'credentials', ltgRemote.credentials);
        });
      });
    </script>
    <script>
      ltg.element('ltgRequest', function() {
        this.noShadow = true;
        this.bindings = {
          '*': 'send',
          '=': 'data'
        };

        this.controller(function($element, $attrs) {
          this.append = function() {};
        });
        
        this.link(function(element, attrs, ltgRequest) {
          var auto = attrs.$get('auto');
          attrs.$set('send', (!auto || (auto && auto !== 'false')));
          D.bind(element, 'append', ltgRequest.append);
        });
      });
    </script>
    <script>
      ltg.element('ltgRemoteSubmit', ['HTMLButtonElement'], function() {
        this.noShadow = true;
        this.link(function(element, attrs) {
          var request = document.querySelector(attrs.$get('for'))
            || (element.form && element.form.parentNode);
          if(request) {
            attrs.$set('type', 'button');
            element.addEventListener('mousedown', function(evt) {
              evt.preventDefault();
              request.setAttribute('send', 'true');
            });
          }
        });
      });
    </script>
    <script>
    ltg.element('remoteRender', function() {
      this.noShadow = true;

      this.link(function(element, attrs) {
        D.on(element, 'request', function(evt) {
          evt.detail.then(function(data) {
            var ref = document.querySelector(attrs.ref);
            if(ref) {
              ref[attrs.type === 'html'? 'innerHTML': 'innerText'] = data;
            }
          });
        });
      });
    });
    </script>
  </body>
</html>