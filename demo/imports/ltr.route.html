<html>
  <head>
    <title>ltg - Path Route Library</title>
    <link rel="import" href="ltr.remote.html">
    <link rel="import" href="ltr.route.service.html">
    <link rel="import" href="ltr.route.view.html">
  </head>
  <body>
    <script type="text/javascript">
    /*0
    <ltg-route path="{service}" view="view id?"></ltg-route>

    <!-- link the content of the path to the view only on succsfull creation of the controller -->
    <!-- template - id or uri of the template which would be rendered for the given view / in case of using a uri it should be
    bound by an remote (used to make ajax/server calls) tag -->
    <ltg-route for="view id?">
      <ltg-path controller="" src="">/</ltg-path>
      <ltg-path controller="" src="">/about</ltg-path>
      <ltg-path controller="" src="">/contact</ltg-path>
      <ltg-path controller="" src="" value="/readme"></ltg-path>
    </ltg-route>

    <remote-http>
      <http-post src="/name" on="auto|change|manual">
        <!-- html form element & inputs -->
        <post-data name="" src="string, css selector"></post-data>
      </http-post>
      <http-get src="/name/{templated}/clear" on="auto|change|manual"></http-get>
    </remote-http>


    <ltg-view path="/sample/name/grand/" is="ltg-view"
      on-ready="method" <!-- method name, would be called once the view's dom is ready. To be used to bind other event for elements insied the view -->
      on-show="method" <!-- request an ajax call to fetch and populate the data -->
      on-hide="method"  <!-- validate and show warning, can prevent the view from unloading -->
      >
      <div is="splash"></div> <!-- preloader element -->
    </ltg-view>
    */
    </script>
    <script type="text/javascript">
      (function() {
        function join(dst) {
          D.forEach(arguments, function(path) {
            if( path !== dst ) {
              dst = dst + ((dst[dst.length - 1] === '/' || path[0] === '/')? '' : '/') + path;
            }
          });
          return dst;
        }

        ltg.element('ltgRoute', ['$routeProvider', '$route', function($routeProvider, $route) {
          this.noShadow = true;

          this.controller(function($element, $attrs) {
            this.path = '';
            this.view = $attrs.view;
            this.remove = function() {};
          });

          this.link(function(element, attrs, ctrls) {
            ctrls.ltgRoute.path = attrs.path || $route.path;
            
            // join((ctrls['^ltgRoute'] && ctrls['^ltgRoute'].path), attrs.path);

            if( ctrls['^ltgRoute'] ) {
              ctrls.ltgRoute.path = join(ctrls['^ltgRoute'].path, ctrls.ltgRoute.path);
              if( !ctrls.ltgRoute.view ) { ctrls.ltgRoute.view = ctrls['^ltgRoute'].view; }
            }
            
            if( attrs.template && attrs.path ) {
              ctrls.ltgRoute.remove = $routeProvider.when(ctrls.ltgRoute.path, {
                view: ctrls.ltgRoute.view,
                template: ctrls.ltgRemote.request(attrs.template), // Pre-fetch the template
                controller: attrs.controller
              });
            }
          }, ['^ltgRemote', '^?ltgRoute']);

          this.unlink(function(element, attrs, ltgRoute) {
            ltgRoute.remove();
          });
        }]);
      })();
    </script>

    <script type="text/javascript">
/*      ltg.element('ltgRoute', ['RouteProvider', function(routeProvider) {
        this.noShadow = true;

        this.controller(function($element, $attrs) {});
        
        this.link(function(element, attrs, ltgRoute) {
          if($attrs.path && $attrs.route) {
            ltgRoute.remove = routeProvider.when($attrs.path, {
              template: $attrs.route,
              view: attrs.view,
              resolve: {},
              controller: ''
            });
          }
        });

        this.unlink(function(element, attrs, ltgRoute) {
          ltgRoute.remove();
        });
      }]);*/
    </script>
  </body>
</html>